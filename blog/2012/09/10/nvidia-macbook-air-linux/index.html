
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Linux on a MacBook Air and Nvidia Projector Woes - Jay McCarthy</title>
  <meta name="author" content="Jay McCarthy">

  
  <meta name="description" content="When I was quite young, in middle school, I switched from Windows to
Linux. I initially used Red Hat, but fairly quickly converted to
Debian. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jeapostrophe.github.com/blog/2012/09/10/nvidia-macbook-air-linux">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/racket.css" rel="stylesheet" type="text/css">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Jay McCarthy" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30131476-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jay McCarthy</a></h1>
  
    <h2>'Cowards die many times before their deaths, The valiant never taste of death but once.'</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jeapostrophe.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://faculty.cs.byu.edu/~jay/home/">Publications</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Linux on a MacBook Air and Nvidia Projector Woes</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-10T00:00:00-06:00" pubdate data-updated="true">Sep 10<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When I was quite young, in middle school, I switched from Windows to
Linux. I initially used Red Hat, but fairly quickly converted to
Debian. Eventually, when OS X first came out I was very excited and
switched to the Mac for my personal machines.</p><p>However, more recently, OS X has been becoming less and less Unix-like
and my tastes for Apple-ism having been reduce, so in December (after
classes were over), I switched back to Linux. First, I used Ubuntu and
then I switched to Arch.</p><p>However, running Linux on a laptop can be exciting, and a MacBook Air
with an Nvidia graphics card is particularly exciting. I had a brutal
problem with my projector setup, but I found the solution. In this
post, I lay out my tale of woe.</p></div>
  
  
    <div style="text-align: center;">
  <script type="text/javascript"><!--
   google_ad_client = "ca-pub-8940021471694041";
   /* jeapostrophe - body */
   google_ad_slot = "2685812826";
   google_ad_width = 728;
   google_ad_height = 90;
   //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>

    <div class="entry-content" style="margin-top: 1em;"><p>Since it&rsquo;s September again, it is time to teach class and I need to
project from my laptop. I&rsquo;d been using multiple displays for a long
time with my Mac (I have an external screen in my office), so I
presumed that I had everything working correctly.</p><p>I use <a href="http://willem.engen.nl/projects/disper/">disper</a> to
manage my display configurations. From Linux&rsquo;s perspective, my Air has
three displays: DFP-0 (the external display when it is connected with
DVI), DFP-1 (the external display when it is connected with VGA), and
DFP-2 (the built-in screen.) So I assumed it would be as simple as
typing <span class="stt">disper -c</span> after connecting to clone my desktop across the two
displays.</p><p>Unfortunately, I got the error message: &#8220;Displays do not share a
common resolution&#8221;. That&rsquo;s strange, I think, I distinctly remember
using these projectors last year, on OS X and getting a decently sized
screen (1024x768, I believe.) A quick <span class="stt">disper -l</span> reveals that my
DFP-1 only has one resolution: &#8220;640x480&#8221;.</p><p>This was right before class, so I just used that resolution only on
the projector and looked up at the screen when I needed to. Ugly, but
workable.</p><p>The next day I read all about XRandr and how you can add video modes
using <span class="stt">gtf</span> and <span class="stt">xrandr</span> and thought I had everything figured
out. When I went to connect again during a day I didn&rsquo;t teach, I had
an unbearable time of getting tons and tons of error messages and no
success.</p><p>I dealt with the small screen in class for a second day.</p><p>After that, I decided that I would connect with OS X on my laptop and
write down which video modes, resolutions, refresh rates, etc it could
handle so I could pass the correct arguments to <span class="stt">gtf</span>. I was delighted
when I realized I&rsquo;d be able to run the projector at 1400x1050 and my
laptop screen at 1440x900 and have them share a 1400x900 desktop. This
wasn&rsquo;t the default in OS X, but it was an option.</p><p>Booting back to Linux, I had a harrowing experience trying to override
the X server settings to get this mode enabled. Nothing.</p><p>At this point, I realized that I originally chose <span class="stt">disper</span> rather than
<span class="stt">xrandr</span> because Nvidia cards haven&rsquo;t always fully supported <span class="stt">xrandr</span>,
but used another &#8220;meta mode&#8221; system instead. I decided to use a meta
mode:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">nvidia-settings &#8211;assign CurrentMetaMode=&#8221;DFP-2: 1440x900 { ViewPortIn=1400x900, ViewPortOut=1400x900+20+0 }, DFP-1: 1400x1050 { ViewPortIn=1400x900, ViewPortOut=1400x900+0+75 }&#8221;</span></p><p>Unfortunately, this failed too, and would sometimes crash my X
server. But I was able to at least mirror the screen on the projector
on my laptop, but it was a small resolution (640x480) and it was
unscaled on my computer, so it was a tiny little box:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">nvidia-settings &#8211;assign CurrentMetaMode=&#8221;DFP-2: 1440x900 { ViewPortIn=640x480, ViewPortOut=640x480+400+210 }, DFP-1: 640x480 { ViewPortIn=640x480, ViewPortOut=640x480+0+0 }&#8221;</span></p><p>But I continued to try&#8230;</p><p>I inspected the logs and found that I got the error message &#8220;Unable to
read EDID for display device DFP-1&#8221;. A quick run to Wikipedia told me
that EDID is the format for giving the valid display frequencies for
devices&#8230; so maybe OS X was reading it correctly but Linux wasn&rsquo;t?</p><p>I found an OS X app that would save EDID data and saved mine for the
projector (after booting into OS X.) Unfortunately after parsing it,
it said that it was fake data and that actually the EDID couldn&rsquo;t be
read. Defeated again.</p><p>This was a fruitful path though, because it made me discover the
<span class="stt">ModeValidation</span> option in my X config where I could add
<span class="stt">AllowNonEdidModes</span> so that the X server wouldn&rsquo;t insist on only using
modes that were given by the EDID block.</p><p>Failure.</p><p>Next, I tried to turn off other checks on valid modes:</p><p><span class="stt">NoHorizSyncCheck</span></p><p>Failure.</p><p><span class="stt">NoVertRefreshCheck</span></p><p>Failure.</p><p><span class="stt">NoDFPNativeResolutionCheck</span></p><p>Failure.</p><p>I had almost given up. I decided to read through the entire Nvidia X
configuration manual and I discovered the <span class="stt">ModeDebug</span> option that
would give detailed reasons for why certain modes were not allowed. I
turned that on, restarted X, and tried to use the big resolution&#8230;</p><p>The error message was &#8220;pixel clock exceeds maximum EDID pixel
clock&#8221;. I don&rsquo;t know what a pixel clock is, but I looked in the manual
and found another mode validation override:</p><p><span class="stt">NoEdidMaxPClkCheck</span></p><p>Success.</p><p>Now, I can use my projector at the full resolution. And it&rsquo;s
beautiful.</p><p>It&rsquo;s days like this that make you proud to be a Linux user. I&rsquo;ve
subdued the computer and made it do exactly what I want. It feels
glorious.</p><p>The only remaining problems I have with the laptop are&#8230; the
microphone doesn&rsquo;t work and sometimes (maybe once every three weeks)
the X server will segfault, normally right after coming back from
sleep. This last thing is the worst because there&rsquo;s no way to reset
the video settings, so I have to reboot. The saga will continue&#8230;</p>
</div>
  


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jay McCarthy</span></span>

      








  


<time datetime="2012-09-10T00:00:00-06:00" pubdate data-updated="true">Sep 10<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/apple/'>Apple</a>, <a class='category' href='/blog/categories/linux/'>Linux</a>, <a class='category' href='/blog/categories/nvidia/'>Nvidia</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://jeapostrophe.github.com/blog/2012/09/10/nvidia-macbook-air-linux/" data-via="jeapostrophe" data-counturl="http://jeapostrophe.github.com/blog/2012/09/10/nvidia-macbook-air-linux/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/09/03/system-f-hoas-2/" title="Previous Post: System F: Interpreter and Type Checker, HOAS style">&laquo; System F: Interpreter and Type Checker, HOAS style</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/09/19/omnifocus-and-org-mode/" title="Next Post: Switching from OmniFocus to Org-Mode">Switching from OmniFocus to Org-Mode &raquo;</a>
      
    </p>
  </footer>
</article>

<div style="text-align: center;">
  <script type="text/javascript"><!--
   google_ad_client = "ca-pub-8940021471694041";
   /* jeapostrophe - body */
   google_ad_slot = "2685812826";
   google_ad_width = 728;
   google_ad_height = 90;
   //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>



  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>I am an assistant professor at <a href="http://byu.edu">Brigham Young University</a> in the
  <a href="http://cs.byu.edu">Computer Science department</a>. I work
  on the <a href="http://racket-lang.org/">Racket</a> programming
  language</a>.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/10/02/multi-language-nirvana/">The Multi-language Nirvana</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/19/omnifocus-and-org-mode/">Switching from OmniFocus to Org-Mode</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/10/nvidia-macbook-air-linux/">Linux on a MacBook Air and Nvidia Projector Woes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/03/system-f-hoas-2/">System F: Interpreter and Type Checker, HOAS style</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/28/system-f-hoas/">System F: Interpreter and Type Checker</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("jeapostrophe", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/jeapostrophe" class="twitter-follow-button" data-show-count="false">Follow @jeapostrophe</a>
  
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/101670206687664104937?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section style="text-align: center;">
  <script type="text/javascript"><!--
    google_ad_client = "ca-pub-8940021471694041";
    /* jeapostrophe - side */
    google_ad_slot = "3412706495";
    google_ad_width = 200;
    google_ad_height = 200;
    //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/jeapostrophe">@jeapostrophe</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jeapostrophe',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Jay McCarthy -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jaymccarthy';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://jeapostrophe.github.com/blog/2012/09/10/nvidia-macbook-air-linux/';
        var disqus_url = 'http://jeapostrophe.github.com/blog/2012/09/10/nvidia-macbook-air-linux/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
